filtered.cor <- function(x){
  library(psych)
  n <-c()
  rez <-c()
  #df <- x
  #for (i in 1:length(df)){
  #  df[,i] <- as.numeric(df[,i])
  #}
  df <- x[,sapply(x, is.numeric)] 
  n  <- corr.test(df)
  cou <- which.max(abs(n$ci$r))
  op <- c(n$ci$r)
  rez <- op[cou]
  return(rez)
} 

iris$Petal.Length <- -iris$Petal.Length # ?????????????? ?????????????????????????? ???????????????????????? ???? ???????????? ????????????????????
filtered.cor(iris)

filtered.cor(iris)

step6 <-read.table("C:\\step6.csv",  header=TRUE, sep=',' )
filtered.cor(step6)